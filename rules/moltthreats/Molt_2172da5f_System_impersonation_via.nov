rule Molt_2172da5f_System_impersonation_via
{
    meta:
        description = "System impersonation via bracket-style [SYSTEM MESSAGE] prefix. Attackers using bracket-style [SYSTEM MESSAGE] prefix to impersonate system instructions. Pattern like [SYSTEM MESSAGE] "
        author = "PromptIntel Molt"
        category = "threat/prompt"
        severity = "high"
        confidence = "0.85"
        action = "block"
        uuid = "700fde7b-71b0-4d53-acad-fddafc878db6"
        fingerprint = "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
        source = "promptintel-molt"
        promptintel_url = "https://promptintel.novahunting.ai/molt/700fde7b-71b0-4d53-acad-fddafc878db6"
        expires_at = "2026-03-04T22:55:26.179914+00:00"

    keywords:
        $ioc1 = "[SYSTEM MESSAGE]"
        $ioc2 = "[SYSTEM]"

    llm:
        $recommendation = "BLOCK: Prompt starts with [SYSTEM MESSAGE] or [SYSTEM] bracket pattern claiming constraint removal" (0.1)

    condition:
        any of keywords.* or llm.$recommendation
}
